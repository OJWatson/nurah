% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/simulate.R
\name{aggregate_simulated_data}
\alias{aggregate_simulated_data}
\title{Aggregate Daily Simulation Data to Periods}
\usage{
aggregate_simulated_data(
  daily_data,
  time_seq_out = NULL,
  resolution = NULL,
  start_date = NULL
)
}
\arguments{
\item{daily_data}{A data frame of daily data by region, containing at least a
\code{date} column and various numeric indicator columns to aggregate.}

\item{time_seq_out}{(Optional) A Date vector of period start dates to aggregate by.
If provided, these define the boundaries for aggregation (with an additional boundary
at the end of the simulation). If not provided, \code{resolution} must be given.}

\item{resolution}{(Optional) The target time resolution for aggregation, as a string
(e.g., \code{"week"}, \code{"month"}). Ignored if \code{time_seq_out} is supplied.
If \code{time_seq_out} is not given, the function will derive period breaks from
the minimum date in \code{daily_data} at the specified resolution.}

\item{start_date}{(Optional) If \code{time_seq_out} is not given, an anchor start date
for the periods (defaults to the first date in \code{daily_data}). This date will
be used as the start of the first period.}
}
\value{
A data frame aggregated by region and time period. It contains one row per
region per period. The output includes all region identifier columns, a \code{date}
column indicating the start date of each period, and all numeric indicator columns
aggregated. Flow metrics (e.g., daily counts) are summed over the period, while the
\code{population} column (if present) is taken as the last day's value in the period.
}
\description{
Aggregates detailed daily simulation outputs into the specified temporal resolution
(e.g., weekly, monthly) by region. This function sums flow variables over each
period and carries forward stock variables like population as of the end of each period.
}
\details{
The function first determines the period intervals either from \code{time_seq_out}
or by generating a sequence based on \code{start_date} and \code{resolution}. It then
assigns each daily record to a period. Aggregation is performed by grouping by region
(all region hierarchy columns) and period start, and summing all numeric columns. For
stock variables such as population, the function automatically takes the last observed
value in each period (instead of summing). Additional logic can be added for other
stock variables if needed.
}
\examples{
# Create a simple daily dataset for one region
daily <- data.frame(
  region = "Region1",
  date = seq.Date(as.Date("2021-01-01"), by = "day", length.out = 10),
  cases = 1:10,          # some flow variable (e.g., daily cases)
  population = 100 + 0:9 # a stock variable that increases daily
)
# Aggregate to weekly periods (2 weeks from the start date)
weekly <- aggregate_simulated_data(daily, resolution = "week")
weekly
# The 'cases' for each week are summed, 'population' is the last day's population in that week.
}
